<tal:main xmlns:i18n="http://xml.zope.org/namespaces/i18n" i18n:domain="voteit.core">
<li class="tab dropdown_menu">
    <a href="#" class="menu_header">
        <span class="iconpadding poll-dark">
            <span>
                <tal:unread condition="unread_polls_count">(${unread_polls_count})</tal:unread>
                ${menu_title} &raquo;
            </span>
        </span>
    </a>
    <ul class="menu_body">
        <tal:polls condition="show_polls">
            <tal:section repeat="section sections">
                <tal:defs define="metadatas polls_metadata[section]">
                <tal:exists condition="metadatas">
                    <li class="readonly iconpadding ${section}"><span>${api.translate(section.title())}</span></li>
                    <li tal:repeat="poll_metadata metadatas">
                        <a href="${poll_metadata['path']}"
                           tal:attributes="class api.userid in poll_metadata.get('unread',()) and 'unread' or ''">
                            <tal:not_voted condition="api.userid not in poll_metadata['voted_userids']">*</tal:not_voted>
                            ${poll_metadata['title']}
                        </a>
                    </li>
                </tal:exists>
                </tal:defs>
            </tal:section>
            <li class="meta"><br/>
                * <span i18n:translate="">means you've not voted in that poll.</span>
            </li>
        </tal:polls>
        <li tal:condition="not show_polls" i18n:translate="">(No polls yet)</li>
    </ul>
</li>

</tal:main>
