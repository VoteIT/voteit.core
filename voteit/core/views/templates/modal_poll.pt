<tal:main xmlns:i18n="http://xml.zope.org/namespaces/i18n" i18n:domain="voteit.core">
<div tal:attributes="class 'listing_block poll ' + context.poll_plugin_name;
                     name context.__name__;
                     id context.uid;">

    <div class="poll_header">
        <span tal:condition="api.show_moderator_actions" tal:replace="structure api.get_moderator_actions(context)">
             Cogwheel menu
        </span>
        <h2 i18n:translate="">Poll</h2>
    </div>
		
	<div class="poll_wrapper">
        <h3 tal:content="context.title">Title</h3>
        <div class="wf_state">
            <span class="iconpadding icon ${wf_state}">
            ${api.tstring(context.get_workflow_state().title())}
            </span>
        </div>

		<div class="description listing_block"
		     tal:condition="context.description"
             tal:content="structure context.description">
                 Description</div>

        <div class="listing_block">
            <strong i18n:translate="">Poll method</strong>: <span tal:content="poll_plugin.title|'Broken plugin'">Title</span>
            <p tal:content="structure poll_plugin.description|''">Description</p>
        </div>

		<div tal:condition="wf_state == 'ongoing'"
		     class="vote_form_area" tal:content="structure form">Initial poll form rendered here</div>

        <div tal:condition="wf_state == 'closed' and api.userid in context" class="toggle_area toggle_closed">
            <a class="toggle_minimize" href="#">Show your vote</a>
            <div class="vote_form_area minimizable_area" tal:content="structure form">Readonly poll form here</div>
        </div>

        <tal:poll_closed condition="wf_state == 'closed'">
            <div class="result" 
                 tal:content="structure context.render_poll_result(request, api)">Poll result</div>
        </tal:poll_closed>

		<div tal:condition="success_msg|False" class="success message">${success_msg}</div>
		<div class="error message"></div>
		
	</div>

	<div class="poll_footer">
        <div class="iconpadding icon time start" 
             tal:define="start_time api.dt_util.dt_format(context.start_time)">
            <span tal:condition="wf_state in ('private', 'upcoming', )"
                  i18n:translate="">Starts</span>
            <span tal:condition="wf_state in ('ongoing', 'closed', 'canceled')"
                i18n:translate="">Started</span>
            <span tal:replace="start_time">1970-10-10</span>
        </div>
        <div class="iconpadding icon time end"
             tal:define="end_time api.dt_util.dt_format(context.end_time)">
            <span tal:condition="wf_state in ('private', 'upcoming', 'ongoing', )"
                  i18n:translate="">Closes</span>
            <span tal:condition="wf_state in ('closed', 'canceled')"
                i18n:translate="">Closed</span>
            <span tal:replace="end_time">1970-10-10</span>
        </div>
	</div>
</div>
</tal:main>
