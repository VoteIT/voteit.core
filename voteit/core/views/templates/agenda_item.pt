<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:use-macro="api.main_template.macros['master']">
<body>

    <div id="content" metal:fill-slot="content">
    
        <h1>Poll(s)</h1>
                    
        <tal:iterate condition="polls" repeat="poll polls">
            <div tal:define="poll_plugin poll.get_poll_plugin();
                             state_id poll.get_workflow_state();
                             unread api.is_unread(poll, True);"
                 tal:attributes="class unread and 'unread listing_block' or 'listing_block'">
                <h3 tal:content="poll.title">Title</h3>
                <div tal:content="poll.description">Description</div>
                
                <div>
                    <span>Poll method:</span>
                    <strong tal:content="poll_plugin.title">Title</strong>
                </div>

                <div class="wf-info">
                    <span>State:</span>
                    <strong tal:attributes="class 'wf-state-%s' % state_id"
                          tal:content="state_id">open</strong>
                </div>
                
                <div tal:condition="state_id == 'closed'" tal:content="structure poll.render_poll_result()">
                    Poll result
                </div>

                <div tal:replace="structure api.get_action_bar(poll, request)">Action bar</div>
                <div tal:condition="poll_forms[poll.uid]|False" tal:content="structure poll_forms[poll.uid]"></div>
            </div>
        </tal:iterate>
        
        <tal:no_polls condition="not polls">
            <h3>No polls yet</h3>
        </tal:no_polls>
        <div style="clear: both"></div>
        <div class="column">
            <div id="discussions">
                <h1>Discussion</h1>
                    
                <tal:iterate condition="discussions" repeat="post discussions">
                    <div tal:define="unread api.is_unread(post, True)"
                         tal:attributes="class unread and 'unread listing_block' or 'listing_block'">
                        <tal:creators tal:replace="structure api.get_creators_info(post.creators, request)">Creators</tal:creators>
                        
                        <span class="body" tal:content="structure post.get_field_value('text')">text</span>

                        <div class="expressions" tal:content="structure api.expressions.get_expressions(post, 'support', api.userid, 'Support')"></div>
                        <div tal:replace="structure api.get_action_bar(post, request)">Action bar</div>
                        <div class="clear"><!-- --></div>
                    </div>

                </tal:iterate>

                <div tal:condition="discussion_form|False" tal:replace="structure discussion_form">Discussion form</div>
            </div>
        </div>

        <div class="column">
            <div id="proposals">
                <h1>Proposal(s)</h1>
                    
                <tal:iterate condition="proposals" repeat="proposal proposals" >
                    <div tal:define="unread api.is_unread(proposal, True)"
                         tal:attributes="class unread and 'unread listing_block' or 'listing_block'">
                        <tal:creators tal:replace="structure api.get_creators_info(proposal.creators, request)">Creators</tal:creators>
                        <span>propose:</span>
                        <span class="body" tal:content="structure proposal.title">Title</span>
                        
                        <div tal:define="state_id proposal.get_workflow_state()">
                            <span>State:</span>
                            <strong tal:attributes="class 'wf-state-%s' % state_id"
                                  tal:content="state_id">private</strong>
                        </div>
                        <div class="expressions" tal:content="structure api.expressions.get_expressions(proposal, 'support', api.userid, 'Support')"></div>
                        <div tal:replace="structure api.get_action_bar(proposal, request)">Action bar</div>
                        <div class="clear"><!-- --></div>
                    </div>
                    
                </tal:iterate>
                
                <div tal:condition="proposal_form|False" tal:replace="structure proposal_form">Proposal form</div>
            
            </div>
            
        </div>
        <div class="clear"><!-- --></div>

    </div>
</body>
</html>
