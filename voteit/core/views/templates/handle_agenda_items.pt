<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      metal:use-macro="load: ${api.template_dir}base_edit.pt"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="voteit.core">
<body>
	<div metal:fill-slot="form" class="content_wrapper">
		<tal:menu 
	    	replace="structure api.render_single_view_component(context, request, 'agenda_item', 'edit_menu')">
	    	Edit menu
	    </tal:menu>
	    <form method="post" class="deform agenda-item-handle">
    		<table class="listing">
    			<tbody>
		    	<tal:states repeat="state states">
		    		<tr>
		    			<td colspan="6"><h3 class="iconpadding icon ${state}" tal:content="translated_state_title(state)">State</h3></td>
		    		<tr>
					<tr class="thead">
						<th class="heading state">&nbsp;</th>
						<th class="heading" i18n:translate="">Agenda item</th>
						<th class="heading edit" i18n:translate="">Edit</th>
						<th class="heading enabled" i18n:translate="">Allow proposals</th>
						<th class="heading enabled" i18n:translate="">Allow discussions</th>
						<th class="heading delete" i18n:translate="">Delete</th>
					</tr>
	    			<tal:ais repeat="ai ais[state]">
					<tr tal:attributes="class repeat.ai.odd and 'odd'" tal:define="obj find_resource(api.root, ai['path'])">
						<td>
							<input type="checkbox" name="ais" value="${ai['name']}"></input>
						</td>
						<td><a href="${ai['path']}">${ai['title']}</a></td>
						<td class="edit"><a href="${ai['path']}/edit?came_from=${came_from}" class="buttonize edit" i18n:translate="">Edit</a></td>
						<td class="enabled" tal:define="block_state obj.get_field_value('proposal_block', False) and '0' or '1'">
							<a href="${request.resource_url(obj, '_toggle_block', query={'proposal_block': block_state})}"
								tal:attributes="class obj.get_field_value('proposal_block', False) and 'no_icon' or 'yes_icon'">
								${obj.get_field_value('proposal_block', False) and api.tstring('No') or api.tstring('Yes')}
							</a>
						</td>
						<td class="enabled" tal:define="block_state obj.get_field_value('discussion_block', False) and '0' or '1'">
							<a href="${request.resource_url(obj, '_toggle_block', query={'discussion_block': block_state})}"
								tal:attributes="class obj.get_field_value('discussion_block', False) and 'no_icon' or 'yes_icon'">
								${obj.get_field_value('discussion_block', False) and api.tstring('No') or api.tstring('Yes')}
							</a>
						</td>
						<td class="delete"><a href="${ai['path']}/delete?came_from=${came_from}" class="delete">
							<img src="${request.application_url}/static/icons/icon_delete.png"
				                 width="16" height="16"
				                 alt="Delete"
				                 title="Delete"
				                 i18n:attributes="alt; title;" />
							</a></td>
					</tr>
	    			</tal:ais>
		    	</tal:states>
		    	</tbody>
    		</table>
	    	<p>&nbsp;</p>
	    	<p>
	    		<label for="state_id" i18n:translate="">Change state on marked items to</label><br />
	    		<select id="state_id" name="state_id">
	    			<option tal:repeat="state states" value="${state}">${translated_state_title(state)}</option>
	    		</select>
    		</p>
    		<p>
	    		<button class="buttonize" type="submit" name="change" i18n:translate="">Change</button>
	    		<button class="buttonize" type="submit" name="cancel" i18n:translate="">Cancel</button>
	    	</p>
	    </form>
	</div>
</body>
</html>