<tal:main xmlns:i18n="http://xml.zope.org/namespaces/i18n" i18n:domain="voteit.core">

<div tal:condition="over_limit"
     class="load_more">
    <a tal:attributes="href api.resource_url(context, request) + '?discussions=all#discussions'"
       i18n:translate="">
        Show
        <span tal:content="over_limit" i18n:name="count">5</span>
        previous posts
    </a>
</div>
<div tal:condition="not limit"
     class="load_more">
    <a tal:attributes="href api.resource_url(context, request) + '#discussions'"
       i18n:translate="">
        Show the last 5 posts
    </a>
</div>

<tal:iterate condition="discussions" repeat="post discussions">
    <div tal:define="unread api.is_brain_unread(post);
    				 truncated truncate(post['title'], truncate_length)"
         tal:attributes="class unread and 'unread listing_block' or 'listing_block';
		                 name post['name'];
		                 id post['uid'];">

        <span tal:condition="api.show_moderator_actions" tal:replace="structure api.get_moderator_actions(post)">
             Cogwheel menu
        </span>

        <tal:creators tal:replace="structure api.get_creators_info(post['creators'])">Creators</tal:creators>
        <span class="body" tal:content="structure truncated[0]">text</span>
        <span class="more" tal:condition="truncated[1]"><a tal:attributes="href '%s%s/@@more' % (request.application_url, post['path'])" i18n:translate="">Read more</a></span>
        <div class="meta">	
            <span class="time" tal:content="api.dt_util.relative_time_format(post['created'])"></span>
            <span class="hyphen">&#45;</span>
            <span tal:condition="show_delete(post)">
                <a class="delete"
                   tal:attributes="href '%s%s/@@delete' % (request.application_url, post['path'])"
                   i18n:translate="">Delete</a>
                <span class="hyphen">&#45;</span>
            </span>

            <span class="user_tags" tal:content="structure api.render_view_group(post, request, 'user_tags')"></span>
        </div>
        <div class="clear"><!-- --></div>
    </div>

</tal:iterate>
</tal:main>
