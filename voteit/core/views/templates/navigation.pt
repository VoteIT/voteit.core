<metal:main define-macro="navigation" tal:define="meeting api.find_meeting(context)">
<div class="content_wrapper">
	<tal:root condition="not meeting">
	<tal:iterate repeat="meeting api.root.values()">
		<h3>
			<a tal:attributes="href api.resource_url(meeting, request)"
			   tal:content="meeting.get_field_value('title')">Meeting title</a>
		</h3>
		
	</tal:iterate>
	</tal:root>
	
	<tal:meeting condition="meeting">
	<tal:agenda_items define="agenda_items api.get_content(meeting, content_type='AgendaItem')">
		<div class="browse_up">
			<a tal:attributes="href api.resource_url(api.root, request)">&laquo; all meetings</a>
		</div>
        <h3>
            <a tal:attributes="href api.resource_url(meeting, request)"
               tal:content="meeting.get_field_value('title')">Meeting title</a>
        </h3>
		<ul tal:condition="agenda_items">
		<tal:iterate repeat="agenda_item agenda_items">
			<li>
                <a tal:attributes="href api.resource_url(agenda_item, request)">
                   	<span tal:content="agenda_item.get_field_value('title')">Agenda item title</span>
					(<span tal:replace="len(api.get_content(agenda_item, content_type='Proposal'))">0</span>)
				</a>
			</li>
		</tal:iterate>
		</ul>
	</tal:agenda_items>
	</tal:meeting>
</div>
</metal:main>