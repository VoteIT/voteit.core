<tal:main xmlns:i18n="http://xml.zope.org/namespaces/i18n" i18n:domain="voteit.core">

<ul id="meeting-actions-menu">
    
    <li class="tab dropdown_menu" tal:condition="show_polls|False">
        <a href="#" class="menu_header">
        	<span class="iconpadding poll-dark">
                <span>
	        		<tal:unread condition="unread_polls_count">(${unread_polls_count})</tal:unread>
                	<tal:polls i18n:translate="">Polls</tal:polls> &raquo;
				</span>
			</span>
        </a>
        <ul class="menu_body">
            <tal:section repeat="section sections">
                <tal:defs define="metadatas polls_metadata[section]">
                <tal:exists condition="metadatas">
                    <li class="readonly iconpadding ${section}"><span>${api.translate(section.title())}</span></li>
                    <li tal:repeat="poll_metadata metadatas">
                        <a href="${poll_metadata['path']}"
						   tal:attributes="class api.userid in poll_metadata.get('unread',()) and 'unread' or ''">
                            ${poll_metadata['title']}
                        </a>
                    </li>
                </tal:exists>
                </tal:defs>
            </tal:section>
        </ul>
    </li>
    
    <tal:meeting condition="api.meeting and is_moderator">
        <li class="tab dropdown_menu">
            <a href="#" class="menu_header iconpadding">
            	<span class="cog-dark" i18n:translate="">Moderator menu</span> &raquo;
			</a>
            <ul class="menu_body">
                <li>
                    <a tal:attributes="href api.resource_url(api.meeting, request) + '@@participant_permissions'"
                        i18n:translate="">Edit permissions</a>
                </li>
                <li tal:condition="context.get_workflow_state() != 'private'">
                    <a tal:attributes="href api.resource_url(api.meeting, request) + '@@add_tickets'"
                       i18n:translate="">Invite participants</a>
                </li>
                <li tal:condition="context.get_workflow_state() != 'private'">
                    <a tal:attributes="href api.resource_url(api.meeting, request) + '@@manage_tickets'"
                       i18n:translate="">Manage invites</a>
                </li>
                <li>
                    <a tal:attributes="href api.resource_url(api.meeting, request) + '@@logs'"
                       i18n:translate="">Meeting actions log</a>
                </li>
            </ul>
        </li>
    </tal:meeting>
    
    <tal:meeting_menu condition="meetings|False">
        <li class="tab dropdown_menu">
            <a href="#" class="menu_header"><span i18n:translate="">Meetings</span> &raquo;</a>
            <ul class="menu_body">
                <tal:iterate repeat="meeting meetings">
                    <li>
                        <a tal:attributes="href api.resource_url(meeting, request)"
                           tal:content="meeting.title">Meeting Title</a>
                    </li>
                </tal:iterate>
            </ul>
        </li>
    </tal:meeting_menu>

    <tal:participants condition="api.userid and api.meeting">
        <li class="tab">
            <a tal:attributes="href '%s@@participants' % api.resource_url(api.meeting, request);"
                       i18n:translate="">Participants</a>
        </li>
    </tal:participants>
    
</ul>

</tal:main>
