<tal:main xmlns:i18n="http://xml.zope.org/namespaces/i18n" i18n:domain="voteit.core">
<div tal:attributes="id toggle_id;
                     class closed_section and 'toggle_area toggle_closed' or 'toggle_area toggle_opened';">
    <h6 class="toggle_minimize reload">
        <span href="${request.url}" class="iconpadding icon ${state}">${section_title}</span>
    </h6>
	
    <tal:open_section condition="not closed_section">
	    <ul class="section">
	        <tal:iterate condition="brains" repeat="brain brains">
	            <tal:defs define="current_context in_current_context(request.path, brain['path'])">
	            <li tal:attributes="class current_context and 'selected minimizable_area' or 'plain minimizable_area'"
	                tal:define="prop_unread_count not current_context and count_query(brain['path'], 'Proposal', unread = 1) or 0;
                                disc_unread_count not current_context and count_query(brain['path'], 'DiscussionPost', unread = 1) or 0;">
	                <tal:moderator_menu condition="api.show_moderator_actions">
	                    <span tal:replace="structure api.get_moderator_actions(brain)">
	                         Cogwheel menu
	                    </span>
	                </tal:moderator_menu>
	                <div tal:attributes="class (prop_unread_count or disc_unread_count) and 'item has_unread' or 'item'">
	                    <a tal:attributes="href brain['path']">
	                        <div tal:content="brain['title']">Title</div>
	                        <div class="info">
	                            <span class="cinfo iconpadding icon proposal">
                                    <span class="total"
                                          tal:content="count_query(brain['path'], 'Proposal')">0</span>
                                    <span class="unread" tal:condition="prop_unread_count">(${prop_unread_count})</span>
	                            </span>
	                            <span class="cinfo iconpadding icon discussion">
                                    <span class="total"
                                          tal:content="count_query(brain['path'], 'DiscussionPost')">0</span>
                                    <span class="unread" tal:condition="disc_unread_count">(${disc_unread_count})</span>
	                            </span>
	                        </div>
	                        <div class="clear"><!-- --></div>
	                    </a>
	                </div>
	            </li>
	            </tal:defs>
	        </tal:iterate>
	        <li tal:condition="not brains">
	            <span i18n:translate="">(Nothing)</span>
	        </li>
	    </ul>
    </tal:open_section>
    
    <tal:closed_section condition="closed_section">
        <div class="minimizable_inverted" i18n:translate="">(hidden, click above to open)</div>
    </tal:closed_section>
</div>
</tal:main>
