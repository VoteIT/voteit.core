<tal:main xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="voteit.core">
<div id="ai-diff-proposals" class="col-sm-12">
  <div class="list-group">
    <div class="list-group-item">
      <h4>
        <span class="glyphicon glyphicon-text-background"></span>
        <span tal:condition="not diff_text.title" i18n:translate="">Diff text</span>
        <span tal:condition="diff_text.title">${diff_text.title}</span>
        <a href="${request.resource_url(context, 'edit_diff_text')}" class="btn btn-primary"><span class="glyphicon glyphicon-pencil"></span> <i18n:translate>Edit</i18n:translate></a>
      </h4>
    </div>

    <tal:iter repeat="row paragraphs">
      <div class="list-group-item"
           tal:define="hashtag '%s-%s' % (diff_text.hashtag, repeat['row'].number)">
        <a class="primary-tag" data-load-agenda-item="#content"
           data-ai-name="${context.__name__}"
           href="${request.resource_url(context, query={'tag': hashtag})}">
          #${hashtag}
          <span tal:condition="tags_count.get(hashtag, 0)">(${tags_count.get(hashtag, 0)})</span>

          <a tal:condition="can_add"
             class="btn btn-default btn-xs"
             data-open-modal
             data-modal-dialog-class="modal-lg"
             href="${request.resource_url(context, 'add_diff_proposal', query={'para': repeat['row'].number})}"
             i18n:translate="">
            Add proposal
          </a>
        </a><br/>
        <tal:newlines repeat="line row.splitlines()">${structure: line}<br/></tal:newlines>
      </div>

    </tal:iter>
    <div class="well" i18n:translate="">
      Propose changes to paragraphs using the <em>Add proposal</em> method above.
      Moving, adding or removing paragraphs is done using ordinary proposals below.
    </div>
  </div>
</div>
</tal:main>
