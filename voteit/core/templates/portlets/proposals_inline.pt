<tal:main xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="voteit.core">
<tal:iterate repeat="docid docids">
  <tal:def define="obj contents.next();
                   is_unread docid in unread_docids;">
  <div class="list-group-item" data-uid="${obj.uid}" data-unread="${is_unread and 'true' or 'false'}">
    <div class="text">
      <tal:cog condition="request.is_moderator" replace="structure view.render_template('voteit.core:views/templates/snippets/cogwheel.pt', context = obj)" />
      <tal:creator replace="structure request.creators_info(obj.creators)"></tal:creator>
      <span tal:content="structure request.transform_text(obj.text)">
        Text here
      </span>
    </div>
    <div class="clearfix"></div>
    <div class="metadata row">
      <div class="col-xs-6">
        <a class="primary-tag" href="${request.resource_url(context, query = {'tag': obj.aid})}">
          #${obj.aid}
        </a>
      </div>
      <div class="col-xs-6 text-right">
        <span class="glyphicon glyphicon-time"></span>
        ${request.dt_handler.format_relative(obj.created)}
      </div>
    </div>
    <div class="metadata">
      <tal:meta replace="structure view.render_view_group('metadata_listing', obj)"></tal:meta>
    </div>
  </div>
  </tal:def>
</tal:iterate>
<div id="proposals_load_more" tal:condition="hidden_count">
  <div class="list-group-item">
    <a class="btn btn-primary"
      href="${load_hidden_url}"
      data-replace-parent="#proposals_load_more"
      data-clickable-target
      i18n:translate="">
      <span data-actionmarker="glyphicon glyphicon-refresh rotate-me"></span>
      Load <tal:ts tal:content="hidden_count" i18n:name="num"></tal:ts> hidden</a>
  </div>
</div>
<script type="text/javascript">
  voteit.unread_notify("${request.resource_url(context, '_mark_read')}");
</script>
</tal:main>
